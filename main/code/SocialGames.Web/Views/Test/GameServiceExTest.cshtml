@{
    ViewBag.Title = "GameService Test";
}

<link href="@Url.Content("~/Content/qunit.css")" rel="stylesheet" type="text/css" />
<script src="@Url.Content("~/Scripts/qunit.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/game/ServerInterface.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/game/GameServiceEx.js")" type="text/javascript"></script>


<h1 id="qunit-header">GameService Tests</h1>

<h2 id="qunit-banner"></h2>
<div id="qunit-testrunner-toolbar"></div>
<h2 id="qunit-userAgent"></h2>
<ol id="qunit-tests"></ol>
<div id="qunit-fixture">test markup, will be hidden</div>

<script type="text/javascript">
    $(function () {
        var apiURL = "http://127.0.0.1:81/";
        var blobURL = "http://127.0.0.1:10000/devstoreaccount1/";

        var si = new ServerInterface();
        var gs = new GameService(apiURL, blobURL, si);

        test("Create Game Queue", function () {
            var success = function (result) { ok(true); start(); };
            stop(10000);
            expect(1);
            gs.createGameQueue(success);
        });

        test("Join Game Queue", function () {
            var success = function (result) { ok(true); start(); };
            stop(10000);
            expect(1);

            function join(result) {
                gs.joinGameQueue(result, success);
            };

            gs.createGameQueue(join);
        });

        test("Get Game Queue", function () {
            var success = function (result) { ok(true); start(); };
            stop(10000);
            expect(1);

            function getQueue(queueId) {
                gs.getGameQueue(queueId, success);
            };

            gs.createGameQueue(getQueue);
        });

        test("Start Game", function () {
            var success = function (result) { ok(true); start(); };
            stop(10000);
            expect(1);
            var queueId;

            function join(data) {
                queueId = data;
                gs.joinGameQueue(queueId, startGame);
            };

            function startGame(data) {
                gs.startGame(queueId, success);
            };

            gs.createGameQueue(join);
        });
    });
</script>

